import React,{useEffect,useState}from'react';import{ScrollView,View,Text,TextInput,Alert}from'react-native';import{db}from'@/db/sqlite';import{store,mem}from'@/utils/webStore';import HapticPress from '@/components/HapticPress';export default function Materials(){const[title,setTitle]=useState('');const[url,setUrl]=useState('');const[tags,setTags]=useState('');const[note,setNote]=useState('');const[list,setList]=useState<any[]>([]);const database=db();const load=async()=>{if(!database){setList(mem.materials);return;}const rows=await database.getAllAsync?.('SELECT * FROM materials ORDER BY id DESC');setList(rows||[])};useEffect(()=>{load();},[]);const add=async()=>{if(!title){Alert.alert('Введите заголовок');return;}if(!database){store.addMat({title,url,tags,note});setTitle('');setUrl('');setTags('');setNote('');setList(mem.materials);return;}await database.runAsync?.('INSERT INTO materials(title,type,url,tags,note) VALUES (?,?,?,?,?)',[title,'link',url,tags,note]);setTitle('');setUrl('');setTags('');setNote('');load()};return(<ScrollView style={{padding:16,backgroundColor:'#fff'}}><Text style={{fontSize:22,fontWeight:'700'}}>Материалы</Text><TextInput placeholder='Заголовок' value={title} onChangeText={setTitle} style={{borderWidth:1,borderColor:'#ccc',borderRadius:8,padding:10,marginTop:8}}/><TextInput placeholder='URL' value={url} onChangeText={setUrl} style={{borderWidth:1,borderColor:'#ccc',borderRadius:8,padding:10,marginTop:8}}/><TextInput placeholder='Теги' value={tags} onChangeText={setTags} style={{borderWidth:1,borderColor:'#ccc',borderRadius:8,padding:10,marginTop:8}}/><TextInput placeholder='Заметка' value={note} onChangeText={setNote} style={{borderWidth:1,borderColor:'#ccc',borderRadius:8,padding:10,marginTop:8}}/><View style={{height:8}}/><HapticPress style={{padding:10,backgroundColor:'#8B1E2D',borderRadius:10,alignItems:'center'}} onPress={add}><Text style={{color:'#fff'}}>Добавить</Text></HapticPress>{list.map(i=>(<View key={i.id||i.title} style={{borderWidth:1,borderColor:'#e5e7eb',borderRadius:12,padding:12,marginTop:8}}><Text style={{fontWeight:'700'}}>{i.title}</Text>{i.url?<Text style={{color:'#2563eb'}}>{i.url}</Text>:null}{i.tags?<Text style={{color:'#6b7280'}}>{i.tags}</Text>:null}{i.note?<Text>{i.note}</Text>:null}</View>))}<View style={{height:40}}/></ScrollView>) }